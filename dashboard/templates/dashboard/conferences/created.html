{% extends 'dashboard/base.html' %}

{% block title %}Meeting Created - Jitsi Control{% endblock %}
{% block page_title %}Meeting Created{% endblock %}

{% block content %}
<div style="max-width: 700px; margin: 0 auto;">
    <div class="card">
        <div class="card-body text-center" style="padding: 48px;">
            <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #48bb78, #38a169); 
                        border-radius: 50%; display: flex; align-items: center; justify-content: center; 
                        margin: 0 auto 24px; font-size: 32px; color: white;">
                <i class="fas fa-check"></i>
            </div>
            
            <h2 style="font-size: 24px; font-weight: 700; margin-bottom: 8px;">
                Meeting Created Successfully!
            </h2>
            <p style="color: var(--text-secondary); margin-bottom: 32px;">
                {{ conference.display_name|default:conference.room_name }}
            </p>
            
            <div style="background: var(--bg-primary); border-radius: var(--border-radius); 
                        padding: 20px; margin-bottom: 24px;">
                <label style="display: block; font-size: 12px; color: var(--text-muted); 
                              text-transform: uppercase; margin-bottom: 8px;">Meeting URL</label>
                <div class="d-flex gap-2">
                    <input type="text" class="form-control" value="{{ meeting_url }}" 
                           readonly id="meetingUrl" style="text-align: center; font-size: 13px;">
                    <button class="btn btn-secondary" onclick="copyUrl()" title="Copy URL">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>
            
            <div class="d-flex gap-4 justify-center" style="flex-wrap: wrap;">
                <a href="{{ meeting_url }}" target="_blank" class="btn btn-primary" style="padding: 14px 32px;">
                    <i class="fas fa-sign-in-alt"></i> Join Meeting Now
                </a>
                <a href="{% url 'dashboard:create_meeting' %}" class="btn btn-secondary">
                    <i class="fas fa-plus"></i> Create Another
                </a>
            </div>
        </div>
    </div>
    
    <div class="card mt-4">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-share-alt"></i> Share Meeting</h3>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 12px;">
                <button class="btn btn-secondary" onclick="shareEmail()">
                    <i class="fas fa-envelope"></i> Email
                </button>
                <button class="btn btn-secondary" onclick="shareWhatsApp()">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </button>
                <button class="btn btn-secondary" onclick="shareTelegram()">
                    <i class="fab fa-telegram"></i> Telegram
                </button>
                <button class="btn btn-secondary" onclick="copyUrl()">
                    <i class="fas fa-link"></i> Copy Link
                </button>
            </div>
        </div>
    </div>
    
    <div class="card mt-4">
        <div class="card-header">
            <h3 class="card-title"><i class="fas fa-info-circle"></i> Meeting Details</h3>
        </div>
        <div class="card-body">
            <table style="width: 100%;">
                <tr>
                    <td style="padding: 10px 0; color: var(--text-muted);">Room Name</td>
                    <td style="padding: 10px 0; text-align: right;">{{ conference.room_name }}</td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; color: var(--text-muted);">Server</td>
                    <td style="padding: 10px 0; text-align: right;">{{ server.name }}</td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; color: var(--text-muted);">Lobby</td>
                    <td style="padding: 10px 0; text-align: right;">
                        {% if conference.has_lobby %}
                            <span class="badge badge-success">Enabled</span>
                        {% else %}
                            <span class="badge badge-info">Disabled</span>
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 0; color: var(--text-muted);">Password Protected</td>
                    <td style="padding: 10px 0; text-align: right;">
                        {% if conference.is_password_protected %}
                            <span class="badge badge-success">Yes</span>
                        {% else %}
                            <span class="badge badge-info">No</span>
                        {% endif %}
                    </td>
                </tr>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .justify-center {
        justify-content: center;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
const meetingUrl = "{{ meeting_url }}";
const meetingName = "{{ conference.display_name|default:conference.room_name }}";

function copyUrl() {
    navigator.clipboard.writeText(meetingUrl).then(() => {
        alert('Meeting URL copied to clipboard!');
    });
}

function shareEmail() {
    const subject = encodeURIComponent(`Join my Jitsi Meeting: ${meetingName}`);
    const body = encodeURIComponent(`You're invited to join my Jitsi meeting.\n\nMeeting: ${meetingName}\nLink: ${meetingUrl}\n\nClick the link to join!`);
    window.open(`mailto:?subject=${subject}&body=${body}`);
}

function shareWhatsApp() {
    const text = encodeURIComponent(`Join my Jitsi meeting: ${meetingName}\n${meetingUrl}`);
    window.open(`https://wa.me/?text=${text}`, '_blank');
}

function shareTelegram() {
    const text = encodeURIComponent(`Join my Jitsi meeting: ${meetingName}`);
    window.open(`https://t.me/share/url?url=${encodeURIComponent(meetingUrl)}&text=${text}`, '_blank');
}
</script>
{% endblock %}
